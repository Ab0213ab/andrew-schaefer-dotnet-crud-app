@model AquentChallenge.Models.Client

@{
    bool isReadOnly = Convert.ToBoolean(ViewData["IsReadOnly"]);
    var contacts = ViewData["Contacts"] as IEnumerable<AquentChallenge.Models.Person>;
}

<div class="mb-3">
    <label asp-for="CompanyName" class="form-label">Company Name</label>
    @if (!isReadOnly)
    {
        <span asp-validation-for="CompanyName" class="text-danger"></span>
        <input asp-for="CompanyName" class="form-control" />
    }
    else
    {
        <input asp-for="CompanyName" class="form-control" readonly/>
    }
</div>

<div class="mb-3">
    <label asp-for="Website" class="form-label">Website</label>
    @if (!isReadOnly)
    {
        <span asp-validation-for="Website" class="text-danger"></span>
        <input asp-for="Website" class="form-control" />
    }
    else
    {
        <input asp-for="Website" class="form-control" readonly />
    }
</div>

<div class="mb-3">
    <label asp-for="Phone" class="form-label">Phone</label>
    @if (!isReadOnly)
    {
        <span asp-validation-for="Phone" class="text-danger"></span>
        <input asp-for="Phone" class="form-control" />
    }
    else
    {
        <input asp-for="Phone" class="form-control" readonly />
    }
</div>

<div class="mb-3">
    <label asp-for="Address" class="form-label">Address</label>
    @if (!isReadOnly)
    {
        <span asp-validation-for="Address" class="text-danger"></span>
        <input asp-for="Address" class="form-control" />
    }
    else
    {
        <input asp-for="Address" class="form-control" readonly />
    }
</div>

@if (contacts != null && contacts.Any())
{
    <hr />
    <h5>Associated Contacts</h5>
    <ul class="list-group mb-3">
        @foreach (var person in contacts)
        {
            <li class="list-group-item d-flex justify-content-between align-items-center">
                @($"{person.FirstName} {person.LastName}")
                <a asp-controller="People"
                   asp-action="Details"
                   asp-route-id="@person.Id"
                   class="btn btn-sm btn-outline-secondary">
                    View
                </a>
            </li>
        }
    </ul>
}
else
{
    <hr />
    <p class="text-muted fst-italic">No contacts associated with this client.</p>
}
